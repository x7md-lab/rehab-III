---
import { ui, defaultLang } from '../i18n/ui';
import { Image } from 'astro:assets';
import heroImg1 from '../assets/hero/DSC00130.jpg';
import heroImg2 from '../assets/hero/RRW09172.JPG';
import heroImg3 from '../assets/hero/DSC08341.jpg';
import heroImg4 from '../assets/hero/DSC00360.jpg';

const currentLocale = Astro.currentLocale || defaultLang;
const t = ui[currentLocale as keyof typeof ui];

const heroImages = [heroImg1, heroImg2, heroImg3, heroImg4];
---
<section class="relative min-h-screen flex items-center justify-center overflow-hidden text-white py-20">
  <div class="absolute inset-0 z-0 bg-black">
    {heroImages.map((img, index) => (
      <div 
        class={`absolute inset-0 transition-opacity duration-1000 ease-in-out hero-bg-image ${index === 0 ? 'opacity-100 z-10' : 'opacity-0 z-0'}`}
        style={index !== 0 ? "display: none;" : ""}
        data-index={index}
      >
        <Image 
          src={img} 
          alt="Hero Background" 
          class="w-full h-full object-cover opacity-60"
          widths={[640, 768, 1024, 1280, 1536, 1920]}
          sizes="100vw"
          loading={index === 0 ? "eager" : "lazy"}
          fetchpriority={index === 0 ? "high" : "auto"}
          format="jpeg"
        />
      </div>
    ))}
    <div class="absolute inset-0 bg-gradient-to-b from-[#4D1213] to-transparent mix-blend-multiply opacity-90"></div>
    <div class="absolute inset-0 bg-gradient-to-b from-black/30 to-black/60"></div>
  </div>

  <div class="relative z-10 px-4 max-w-7xl mx-auto mt-16">
    <div class="grid md:grid-cols-2 gap-8 md:gap-12 items-center">
      <!-- Logo Column -->
      <div class="flex justify-center md:justify-center" data-aos="fade-down" data-aos-duration="1000">
        <img 
          src="/logowhte.svg" 
          alt="Rehab Logo" 
          class="h-30 md:h-32 lg:h-48 object-contain drop-shadow-2xl w-auto" 
          width="743" 
          height="503"
          loading="eager"
          fetchpriority="high"
        />
      </div>
      
      <!-- Content Column -->
      <div class="text-center md:text-start space-y-8">
        <div class="space-y-4" data-aos="fade-up" data-aos-delay="200">
          <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold leading-tight">
            <span class="block text-white drop-shadow-lg">{t['hero.title_company']}</span>
          </h1>
          <h2 class="text-xl md:text-3xl text-gold font-medium drop-shadow-md">
            {t['hero.subtitle']}
          </h2>
        </div>

        <p class="text-lg md:text-xl text-gray-100 leading-relaxed max-w-lg mx-auto md:mx-0 drop-shadow" data-aos="fade-up" data-aos-delay="400">
           {t['hero.description']}
        </p>
        
        <div class="flex justify-center md:justify-start">
          <a href="#vision" class="bg-secondary hover:bg-red-700 text-white px-8 py-4 rounded-full font-bold text-base transition-all transform hover:scale-105 shadow-lg hover:shadow-xl">
            {t['hero.cta']}
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Simple vanilla JS slideshow
  const slides = document.querySelectorAll('.hero-bg-image');
  let currentSlide = 0;
  
  if (slides.length > 0) {
    setInterval(() => {
      const nextSlide = (currentSlide + 1) % slides.length;
      
      // 1. Prepare next slide: unhide it, but keep it transparent
      const nextEl = slides[nextSlide] as HTMLElement;
      nextEl.style.display = 'block';
      
      // Force reflow to ensure browser registers the display change before transition
      void nextEl.offsetWidth;

      // 2. Start transition
      // Fade out current
      slides[currentSlide].classList.remove('opacity-100', 'z-10');
      slides[currentSlide].classList.add('opacity-0', 'z-0');
      
      // Fade in next
      nextEl.classList.remove('opacity-0', 'z-0');
      nextEl.classList.add('opacity-100', 'z-10');
      
      // 3. Cleanup after transition (1s duration)
      setTimeout(() => {
        const prevEl = slides[currentSlide] as HTMLElement;
        // Only hide if it's not the active slide (in case of rapid changes, though interval is 5s)
        if (!prevEl.classList.contains('opacity-100')) {
             prevEl.style.display = 'none';
        }
        currentSlide = nextSlide;
      }, 1000);

    }, 5000); // Change every 5 seconds
  }
</script>
